<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Jose Coelho ">
<meta name="keywords"
    content="go, golang, kubernetes, ansible, chef, kafka, docker, containers" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<meta name="description" content="Notes on building software">
<link rel="canonical" href="https://www.jacoelho.com/blog/2023/09/structured-logging-slog/" />


<title>
    
    structured logging - slog :: Posts 
    
</title>





<link rel="stylesheet" href="https://www.jacoelho.com/main.1997feb47d52a50d301f3e521a46d5fb4f99f8429fca92ed7f9f316b75893c35.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://www.jacoelho.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.jacoelho.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.jacoelho.com/favicon-16x16.png">
    <link rel="mask-icon" href="https://www.jacoelho.com/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://www.jacoelho.com/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">


<meta itemprop="name" content="structured logging - slog">
<meta itemprop="description" content="Logs (of events) is one of the three pillar of observability (traces and metrics are the other two).
A log entry is a timestamp record about the application&rsquo;s activity, it can be used for troubleshooting, monitoring or auditing purposes.
Logs may have different formats:
unstructured or plain text: similar to print statements, free-form text semi-structured: some values have a structure and the remaining data free-form structured: there is a well-defined and consistent format, for example: W3C Log Format, NCSA Log Format, Key/Value Pair, CSV or JSON, between others."><meta itemprop="datePublished" content="2023-09-11T10:00:00+00:00" />
<meta itemprop="dateModified" content="2023-09-11T10:00:00+00:00" />
<meta itemprop="wordCount" content="1140"><meta itemprop="image" content="https://www.jacoelho.com/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.jacoelho.com/"/>

<meta name="twitter:title" content="structured logging - slog"/>
<meta name="twitter:description" content="Logs (of events) is one of the three pillar of observability (traces and metrics are the other two).
A log entry is a timestamp record about the application&rsquo;s activity, it can be used for troubleshooting, monitoring or auditing purposes.
Logs may have different formats:
unstructured or plain text: similar to print statements, free-form text semi-structured: some values have a structure and the remaining data free-form structured: there is a well-defined and consistent format, for example: W3C Log Format, NCSA Log Format, Key/Value Pair, CSV or JSON, between others."/>



<meta property="og:title" content="structured logging - slog" />
<meta property="og:description" content="Logs (of events) is one of the three pillar of observability (traces and metrics are the other two).
A log entry is a timestamp record about the application&rsquo;s activity, it can be used for troubleshooting, monitoring or auditing purposes.
Logs may have different formats:
unstructured or plain text: similar to print statements, free-form text semi-structured: some values have a structure and the remaining data free-form structured: there is a well-defined and consistent format, for example: W3C Log Format, NCSA Log Format, Key/Value Pair, CSV or JSON, between others." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.jacoelho.com/blog/2023/09/structured-logging-slog/" /><meta property="og:image" content="https://www.jacoelho.com/"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-09-11T10:00:00+00:00" />
<meta property="article:modified_time" content="2023-09-11T10:00:00+00:00" />




<meta property="article:section" content="go" />

<meta property="article:section" content="golang" />

<meta property="article:section" content="logging" />

<meta property="article:section" content="slog" />



<meta property="article:published_time" content="2023-09-11 10:00:00 &#43;0000 UTC" />








<script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
        c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
        t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "3wjiv20hsj");
</script>
    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://www.jacoelho.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">Jose Coelho</span>
            <span class="logo__cursor" style=
                  "visibility:hidden;
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.jacoelho.com/about/">About</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
<main class="post">

    <div class="post-info">
        
        </p>
    </div>

    <article>
        <h2 class="post-title"><a href="https://www.jacoelho.com/blog/2023/09/structured-logging-slog/">structured logging - slog</a></h2>

        

        

        <div class="post-content">
            <p>Logs (of events) is one of the three pillar of observability (traces and metrics are the other two).</p>
<p>A log entry is a timestamp record about the application&rsquo;s activity, it can be used for troubleshooting, monitoring or auditing purposes.</p>
<p>Logs may have different formats:</p>
<ul>
<li>unstructured or plain text: similar to print statements, free-form text</li>
<li>semi-structured: some values have a structure and the remaining data free-form</li>
<li>structured: there is a well-defined and consistent format, for example: <a href="https://www.w3.org/TR/WD-logfile.html">W3C Log Format</a>, <a href="https://en.wikipedia.org/wiki/Common_Log_Format">NCSA Log Format</a>, Key/Value Pair, CSV or JSON, between others. Structured logs can be easily machine parsed, which simplifies analytics, filtering and aggregation.</li>
</ul>
<p>This article is non-exhaustive walkthrough of logging in Go.</p>
<h2 id="unstructured-logging">Unstructured logging</h2>
<p>The <code>log</code> package allows the unstructured log writing:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">LstdFlags</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Hello world!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>LstdFlags</code> is a subset of the semi-structured flags available:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// log/log.go:42
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Ldate</span>         = <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">iota</span>     <span style="color:#75715e">// the date in the local time zone: 2009/01/23
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Ltime</span>                         <span style="color:#75715e">// the time in the local time zone: 01:23:23
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Lmicroseconds</span>                 <span style="color:#75715e">// microsecond resolution: 01:23:23.123123.  assumes Ltime.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Llongfile</span>                     <span style="color:#75715e">// full file name and line number: /a/b/c/d.go:23
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Lshortfile</span>                    <span style="color:#75715e">// final file name element and line number: d.go:23. overrides Llongfile
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">LUTC</span>                          <span style="color:#75715e">// if Ldate or Ltime is set, use UTC rather than the local time zone
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Lmsgprefix</span>                    <span style="color:#75715e">// move the &#34;prefix&#34; from the beginning of the line to before the message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">LstdFlags</span>     = <span style="color:#a6e22e">Ldate</span> |  <span style="color:#a6e22e">Ltime</span> <span style="color:#75715e">// initial values for the standard logger
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>)
</span></span></code></pre></div><p>Although there are some structured flags available, most logging still happens in free-form format.</p>
<h2 id="structured-logging">Structured logging</h2>
<p>There are multiple libraries in Go that support structured logging, one of the most used is <a href="https://github.com/sirupsen/logrus">logrus</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span> <span style="color:#e6db74">&#34;github.com/sirupsen/logrus&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetFormatter</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">JSONFormatter</span>{})
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">WithFields</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fields</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;animal&#34;</span>: <span style="color:#e6db74">&#34;walrus&#34;</span>,
</span></span><span style="display:flex;"><span>	}).<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;A walrus appears&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;animal&#34;:&#34;walrus&#34;,&#34;level&#34;:&#34;info&#34;,&#34;msg&#34;:&#34;A walrus appears&#34;,&#34;time&#34;:&#34;2023-01-01T09:00:00+01:00&#34;}
</span></span></span></code></pre></div><p>Logging can impact the application performance, specially if the logging overhead starts to be noticeable.</p>
<p>There are two libraries in the ecosystem with performance as a main feature: <a href="https://github.com/uber-go/zap">zap</a> and <a href="https://github.com/rs/zerolog">zerolog</a>.</p>
<p>According to the benchmarks provided by the zap project:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Package</th>
<th style="text-align:center">Time</th>
<th style="text-align:center">Time % to zap</th>
<th style="text-align:center">Objects Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">⚡ zap</td>
<td style="text-align:center">1744 ns/op</td>
<td style="text-align:center">+0%</td>
<td style="text-align:center">5 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">⚡ zap (sugared)</td>
<td style="text-align:center">2483 ns/op</td>
<td style="text-align:center">+42%</td>
<td style="text-align:center">10 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">zerolog</td>
<td style="text-align:center">918 ns/op</td>
<td style="text-align:center">-47%</td>
<td style="text-align:center">1 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">go-kit</td>
<td style="text-align:center">5590 ns/op</td>
<td style="text-align:center">+221%</td>
<td style="text-align:center">57 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">slog</td>
<td style="text-align:center">5640 ns/op</td>
<td style="text-align:center">+223%</td>
<td style="text-align:center">40 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">apex/log</td>
<td style="text-align:center">21184 ns/op</td>
<td style="text-align:center">+1115%</td>
<td style="text-align:center">63 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">logrus</td>
<td style="text-align:center">24338 ns/op</td>
<td style="text-align:center">+1296%</td>
<td style="text-align:center">79 allocs/op</td>
</tr>
<tr>
<td style="text-align:left">log15</td>
<td style="text-align:center">26054 ns/op</td>
<td style="text-align:center">+1394%</td>
<td style="text-align:center">74 allocs/op</td>
</tr>
</tbody>
</table>
<p>Looking at the benchmark is evident that logging can impact heavily both latency and memory/gc by several order of magnitude.</p>
<p>Using <code>zerolog</code> as example, the API is still user-friendly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/rs/zerolog&#34;</span>
</span></span><span style="display:flex;"><span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">zerolog</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>).<span style="color:#a6e22e">With</span>().<span style="color:#a6e22e">Timestamp</span>().<span style="color:#a6e22e">Logger</span>()  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>().<span style="color:#a6e22e">Msg</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>)  
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2023-01-01T09:00:00+01:00&#34;,&#34;message&#34;:&#34;hello world&#34;}
</span></span></span></code></pre></div><h2 id="abstraction">Abstraction</h2>
<p>Given the multiple structured logging libraries available, it is a common practice to create an agnostic abstraction to avoid being tied to implementation specifics.</p>
<p>A starting point could be something like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Logger</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Info</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">msg</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">keysAndValues</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">any</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">msg</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">keysAndValues</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">any</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Another option could be using <a href="https://github.com/go-logr/logr">logr</a>, which provides an API without being tied to a specific implementation and without dependencies.</p>
<p>The API is not an interface, but a concrete type for performance reasons:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Logger</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sink</span>  <span style="color:#a6e22e">LogSink</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">level</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Where the <code>LogSink</code> looks similar to a hypothetical logging interface:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// LogSink represents a logging implementation.  End-users will generally not
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// interact with this type.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">LogSink</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Info</span>(<span style="color:#a6e22e">level</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">msg</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">keysAndValues</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">any</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Error logs an error, with the given message and key/value pairs as
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// context.  See Logger.Error for more details.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>, <span style="color:#a6e22e">msg</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">keysAndValues</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">any</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// WithValues returns a new LogSink with additional key/value pairs.  See
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// Logger.WithValues for more details.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">WithValues</span>(<span style="color:#a6e22e">keysAndValues</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">any</span>) <span style="color:#a6e22e">LogSink</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In practice, using <a href="https://github.com/rs/zerolog">zerolog</a> as the <code>LogSink</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/go-logr/zerologr&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/rs/zerolog&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">zl</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">zerolog</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>).<span style="color:#a6e22e">With</span>().<span style="color:#a6e22e">Timestamp</span>().<span style="color:#a6e22e">Logger</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">zerologr</span>.<span style="color:#a6e22e">New</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">zl</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">WithValues</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">42</span>).<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// alternative
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;a&#34;:42,&#34;v&#34;:0,&#34;time&#34;:&#34;2023-01-01T09:00:00+01:00&#34;,&#34;message&#34;:&#34;hello world&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;v&#34;:0,&#34;a&#34;:42,&#34;time&#34;:&#34;2023-01-01T09:00:00+01:00&#34;,&#34;message&#34;:&#34;hello world&#34;}
</span></span></span></code></pre></div><h3 id="slog">slog</h3>
<p>The <code>slog</code>package introduces structured logging as a first class package in the standard library in Go version 1.21.0.</p>
<p>The <a href="https://go.googlesource.com/proposal/+/master/design/56345-structured-logging.md">design document</a> is a good starting point on the decisions and trade-offs.</p>
<p>The library provides different ways to log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log/slog&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">NewJSONHandler</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdout</span>, <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// alternative
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// alternative
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">LogAttrs</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(),
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">LevelInfo</span>, 
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;hello world&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;level&#34;:&#34;INFO&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;level&#34;:&#34;INFO&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;level&#34;:&#34;INFO&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span></code></pre></div><p>An interesting addition, is the interface <code>LogValuer</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// A LogValuer is any Go value that can convert itself into a Value for logging.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// This mechanism may be used to defer expensive operations until they are  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// needed, or to expand a single value into a sequence of components.  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">LogValuer</span> <span style="color:#66d9ef">interface</span> {  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">LogValue</span>() <span style="color:#a6e22e">Value</span>  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Implementing the interface:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log/slog&#34;</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">expensive</span> <span style="color:#66d9ef">struct</span>{ <span style="color:#a6e22e">arg</span> <span style="color:#66d9ef">int</span> }  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">expensive</span>) <span style="color:#a6e22e">LogValue</span>() <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Value</span> {  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">AnyValue</span>(<span style="color:#a6e22e">computeExpensiveValue</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">arg</span>))  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">computeExpensiveValue</span>(<span style="color:#a6e22e">arg</span> <span style="color:#66d9ef">int</span>) <span style="color:#a6e22e">any</span> {  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">arg</span>  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">NewJSONHandler</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdout</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">HandlerOptions</span>{  
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">Level</span>: <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">LevelInfo</span>,  
</span></span><span style="display:flex;"><span>    }))  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#a6e22e">expensive</span>{<span style="color:#ae81ff">5</span>})  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;done&#34;</span>, <span style="color:#e6db74">&#34;took_seconds&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">start</span>).<span style="color:#a6e22e">Seconds</span>())  
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;level&#34;:&#34;INFO&#34;,&#34;msg&#34;:&#34;done&#34;,&#34;took_seconds&#34;:0.000001083}
</span></span></span></code></pre></div><p>In this case only <code>Info</code> or above is logged, the <code>computeExpensiveValue</code> is not called.</p>
<p>Another use case for the <code>LogValuer</code> is redacting sensible information:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#a6e22e">Token</span>) <span style="color:#a6e22e">LogValue</span>() <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Value</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">StringValue</span>(<span style="color:#e6db74">&#34;REDACTED&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>At <code>slog</code> core, the <code>Handler</code> interface log records produced by a <code>Logger</code> (comments omitted for brevity):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Handler</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Enabled</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">Level</span>) <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Handle</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">Record</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">WithAttrs</span>(<span style="color:#a6e22e">attrs</span> []<span style="color:#a6e22e">Attr</span>) <span style="color:#a6e22e">Handler</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">WithGroup</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) <span style="color:#a6e22e">Handler</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <code>slog</code> package provides a <code>TextHandler</code> and  <code>JSONHandler</code>, but a user can pick different implementations. It is possible to use <code>slog</code> with existing log libraries like <code>zap</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log/slog&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;go.uber.org/zap&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;go.uber.org/zap/exp/zapslog&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;go.uber.org/zap/zapcore&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">outputStderr</span> = []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;stdout&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">encoderConfig</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">NewProductionEncoderConfig</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">encoderConfig</span>.<span style="color:#a6e22e">TimeKey</span> = <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">encoderConfig</span>.<span style="color:#a6e22e">EncodeTime</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">t</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>, <span style="color:#a6e22e">enc</span> <span style="color:#a6e22e">zapcore</span>.<span style="color:#a6e22e">PrimitiveArrayEncoder</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">AppendString</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Format</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">RFC3339Nano</span>))
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cfg</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">Config</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Level</span>:            <span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">NewAtomicLevelAt</span>(<span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">InfoLevel</span>),
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Encoding</span>:         <span style="color:#e6db74">&#34;json&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">EncoderConfig</span>:    <span style="color:#a6e22e">encoderConfig</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">OutputPaths</span>:      <span style="color:#a6e22e">outputStderr</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ErrorOutputPaths</span>: <span style="color:#a6e22e">outputStderr</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">zp</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">cfg</span>.<span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">zp</span>.<span style="color:#a6e22e">Sync</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">zapslog</span>.<span style="color:#a6e22e">NewHandler</span>(<span style="color:#a6e22e">zp</span>.<span style="color:#a6e22e">Core</span>(), <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// alternative
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>, <span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// alternative
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">LogAttrs</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(),
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">LevelInfo</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;hello world&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">slog</span>.<span style="color:#a6e22e">Int</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// outputs:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// {&#34;level&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2023-01-01T09:00:00.000000+01:00&#34;,&#34;msg&#34;:&#34;hello world&#34;,&#34;a&#34;:5}
</span></span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Writing structure logs in Go was massively simplified with the introduction of the <code>log/slog</code> package, with the advantage of removing the need for external dependencies.</p>
<p>The usage of packages like <code>logr</code> or creating custom logging interfaces is less relevant, given it is easier to create <code>slog</code> handlers.</p>
<p>The <code>slog</code> performance according to the zap project benchmarks is in a good enough place, although there is room for using zap or zerolog if performance and latency is critical.</p>
<p>Go &ldquo;batteries included&rdquo; philosophy continues to improve with <code>slog</code>addition.</p>

        </div>
    </article>

    <hr />

    <div class="post-info">
        
        
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://www.jacoelho.com/categories/go/">go</a></span>
        <span class="tag"><a href="https://www.jacoelho.com/categories/golang/">golang</a></span>
        <span class="tag"><a href="https://www.jacoelho.com/categories/logging/">logging</a></span>
        <span class="tag"><a href="https://www.jacoelho.com/categories/slog/">slog</a></span>
        
    </p>

    </div>
</main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://www.jacoelho.com/">Jose Coelho</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://www.jacoelho.com/blog/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
</footer>
            
        </div>

        




<script type="text/javascript" src="https://www.jacoelho.com/bundle.min.1b9e9e6a472aac21fc8b84b1563d43d3d13b1ce77ebc8a68655d149bfaaab4764e9768398766fb70a522ecf2fcc92d4fa421f0d409e52cd6e5885a6ae8032220.js" integrity="sha512-G56eakcqrCH8i4SxVj1D09E7HOd&#43;vIpoZV0Um/qqtHZOl2g5h2b7cKUi7PL8yS1PpCHw1AnlLNbliFpq6AMiIA=="></script>



    </body>
</html>
